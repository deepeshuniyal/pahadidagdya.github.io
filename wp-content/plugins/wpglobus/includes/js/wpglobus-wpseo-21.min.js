var wpglobus_wpseo=function(){function a(a,b,c){if("undefined"==typeof a)return"";if("undefined"==typeof replacedVars&&0==jQuery("#title").size())return a;var d="#title",e="#excerpt-"+b,f="#content";b!=WPGlobusAdmin.data.default_language&&(d="#title_"+b,f="#content_"+b),jQuery(d).length&&(a=a.replace(/%%title%%/g,jQuery(d).val())),a=a.replace(/%%sitedesc%%/g,WPGlobusAdmin.data.blogdescription[b]),a=a.replace(/%%sitename%%/g,WPGlobusAdmin.data.blogname[b]),a=a.replace(/%%sep%%/g,wpseoMetaboxL10n.sep),a=a.replace(/%%date%%/g,wpseoMetaboxL10n.date),a=a.replace(/%%id%%/g,wpseoMetaboxL10n.id),a=a.replace(/%%page%%/g,wpseoMetaboxL10n.page),a=a.replace(/%%currenttime%%/g,wpseoMetaboxL10n.currenttime),a=a.replace(/%%currentdate%%/g,wpseoMetaboxL10n.currentdate),a=a.replace(/%%currentday%%/g,wpseoMetaboxL10n.currentday),a=a.replace(/%%currentmonth%%/g,wpseoMetaboxL10n.currentmonth),a=a.replace(/%%currentyear%%/g,wpseoMetaboxL10n.currentyear),a=a.replace(/%%focuskw%%/g,jQuery("#yoast_wpseo_focuskw_"+b).val());var g="";jQuery(e).length&&(g=yst_clean(jQuery(e).val()),a=a.replace(/%%excerpt_only%%/g,g)),""==g&&jQuery(f).length&&(g=jQuery(f).val().replace(/(<([^>]+)>)/gi,"").substring(0,wpseoMetaboxL10n.wpseo_meta_desc_length-1)),a=a.replace(/%%excerpt%%/g,g),jQuery("#parent_id").length&&jQuery("#parent_id option:selected").text()!=wpseoMetaboxL10n.no_parent_text&&(a=a.replace(/%%parent_title%%/g,jQuery("#parent_id option:selected").text()));var h=yst_escapeFocusKw(wpseoMetaboxL10n.sep),j=new RegExp(h+" "+h,"g");if(a=a.replace(j,wpseoMetaboxL10n.sep),a.indexOf("%%")!=-1&&null!=a.match(/%%[a-z0-9_-]+%%/i))for(regex=/%%[a-z0-9_-]+%%/gi,matches=a.match(regex),i=0;i<matches.length;i++)void 0!=replacedVars[matches[i]]?a=a.replace(matches[i],replacedVars[matches[i]]):(replaceableVar=matches[i],replacedVars[replaceableVar]="",jQuery.post(ajaxurl,{action:"wpseo_replace_vars",string:matches[i],post_id:jQuery("#post_ID").val(),_wpnonce:wpseoMetaboxL10n.wpseo_replace_vars_nonce},function(b){b?(replacedVars[replaceableVar]=b,yst_replaceVariables(a,c)):yst_replaceVariables(a,c)}));c(a)}function b(a,b,c){var d,e=yst_escapeFocusKw(jQuery.trim(jQuery("#"+wpseoMetaboxL10n.field_prefix+"focuskw_"+c).val()));if(""==e)return a;d=e.search(" ")!=-1?e.split(" "):new Array(e);for(var f=0;f<d.length;f++){var g=yst_clean(d[f]),h="";b?(g=g.replace(" ","-").toLowerCase(),h=new RegExp("([-/])("+g+")([-/])?")):h=new RegExp("(^|[ s\n\r\t.,'(\"+;!?:-]+)("+g+")($|[ s\n\r\t.,')\"+;!?:-]+)","gim"),void 0!=a&&(a=a.replace(h,"$1<strong>$2</strong>$3"))}return a}function c(a){var c=jQuery.trim(yst_clean(jQuery("#"+wpseoMetaboxL10n.field_prefix+"metadesc_"+a).val())),e=jQuery("<div />"),f=jQuery("#wpseosnippet_"+a);if(""==c&&""!=wpseoMetaboxL10n.wpseo_metadesc_template&&(c=wpseoMetaboxL10n.wpseo_metadesc_template),""!=c)c=yst_replaceVariables(c,function(c){c=e.text(c).html(),c=yst_clean(c);var g;g=wpseoMetaboxL10n.wpseo_meta_desc_length-c.length,g=g<0?'<span class="wrong">'+g+"</span>":'<span class="good">'+g+"</span>",jQuery("#"+wpseoMetaboxL10n.field_prefix+"metadesc-length_"+a).html(g),c=yst_trimDesc(c),c=b(c,!1),f.find(".desc span.autogen").html(""),f.find(".desc span.content").html(c),d(a)});else{jQuery("#"+wpseoMetaboxL10n.field_prefix+"metadesc-length_"+a).html(wpseoMetaboxL10n.wpseo_meta_desc_length),f.find(".desc span.content").html(""),d(a);var g="#content";a!=WPGlobusAdmin.data.default_language&&(g="#content_"+a),jQuery(g).length&&(c=jQuery(g).val(),c=yst_clean(c));var h=yst_escapeFocusKw(jQuery.trim(jQuery("#"+wpseoMetaboxL10n.field_prefix+"focuskw_"+a).val()));if(""!=h){var i=new RegExp(h,"gim");c=c.search(i)!=-1&&c.length>wpseoMetaboxL10n.wpseo_meta_desc_length?c.substr(c.search(i),wpseoMetaboxL10n.wpseo_meta_desc_length):c.substr(0,wpseoMetaboxL10n.wpseo_meta_desc_length)}else c=c.substr(0,wpseoMetaboxL10n.wpseo_meta_desc_length);c=b(c,!1),c=yst_trimDesc(c),f.find(".desc span.autogen").html(c)}}function d(a){var b=jQuery.trim(jQuery("#"+wpseoMetaboxL10n.field_prefix+"focuskw_"+a).val());b=yst_escapeFocusKw(b).toLowerCase();var c="#title",d="#content";a!=WPGlobusAdmin.data.default_language&&(c="#title_"+a,d="#content_"+a);var e=jQuery(document).triggerHandler("wpglobus_post_name_full",{postnamefull:"#editable-post-name-full",language:a})||"#editable-post-name-full";if(jQuery(e).length)var f=jQuery(e).text(),g=wpseoMetaboxL10n.wpseo_permalink_template.replace("%postname%",f).replace("http://","");var h=new RegExp("(^|[ s\n\r\t.,'(\"+;!?:-])"+b+"($|[ s\n\r\t.,')\"+!?:;-])","gim"),i=removeLowerCaseDiacritics(b),j=new RegExp(i.replace(/\s+/g,"[-_\\//]"),"gim"),k=jQuery("#focuskwresults_"+a),l=jQuery("#wpseosnippet_"+a).find(".desc span.content").text();if(""!=b){var m="<p>"+wpseoMetaboxL10n.keyword_header+"</p>";m+="<ul>",jQuery(c).length&&(m+="<li>"+wpseoMetaboxL10n.article_header_text+ptest(jQuery(c).val(),h)+"</li>"),m+="<li>"+wpseoMetaboxL10n.page_title_text+ptest(jQuery("#wpseosnippet_title_"+a).text(),h)+"</li>",m+="<li>"+wpseoMetaboxL10n.page_url_text+ptest(g,j)+"</li>",jQuery(d).length&&(m+="<li>"+wpseoMetaboxL10n.content_text+ptest(jQuery(d).val(),h)+"</li>"),m+="<li>"+wpseoMetaboxL10n.meta_description_text+ptest(l,h)+"</li>",m+="</ul>",k.html(m)}else k.html("")}if("undefined"!=typeof wpseoMetaboxL10n){var e=function(c,e){var f="",g=jQuery("#"+wpseoMetaboxL10n.field_prefix+"title_"+e),h=jQuery("#"+wpseoMetaboxL10n.field_prefix+"title-length-warning_"+e),i=jQuery("<div />"),j=jQuery("#wpseosnippet_title_"+e);return g.val()?f=g.val():(f=wpseoMetaboxL10n.wpseo_title_template,f=i.html(f).text()),""==f?(j.html(""),void h.hide()):(f=yst_clean(f),f=jQuery.trim(f),f=i.text(f).html(),c&&g.val(f),void(f=a(f,e,function(a){var c=i.html(a).text();g.attr("placeholder",c),a=yst_clean(a),a=b(a,!1,e),jQuery("#wpseosnippet_title_"+e).html(a);var f=document.getElementById("wpseosnippet_title_"+e);null!=f&&(f.scrollWidth>f.clientWidth?h.show():h.hide()),d(e)})))},f=function(a){e(!1,a),c(a)},g=function(){jQuery(".yoast_help").qtip({content:{attr:"alt"},position:{my:"bottom left",at:"top center"},style:{tip:{corner:!0},classes:"yoast-qtip qtip-rounded qtip-blue"},show:{when:{event:"mouseover"}},hide:{fixed:!0,when:{event:"mouseout"}}})};jQuery("#wpglobus-wpseo-tabs").tabs();var h=jQuery("#wpglobus-wpseo-attr"),j=jQuery(".wpseotab.general .form-table"),k=h.data("ids"),l=h.data("names"),m="";k=k+","+h.data("qtip"),k=k.split(","),l=l.split(","),jQuery("#wpglobus-wpseo-tabs").insertBefore(j),jQuery(".wpglobus-wpseo-general").each(function(a,b){var d=jQuery(b),g=d.data("language");if(d.html('<table class="form-table wpglobus-table-'+g+'" data-language="'+g+'">'+j.html()+"</table>"),jQuery.each(l,function(a,b){jQuery("#"+b).attr("name",b+"_"+g)}),jQuery.each(k,function(a,b){var c=jQuery("#"+b);"wpseosnippet"==b&&c.addClass("wpglobus-wpseosnippet"),"focuskwresults"==b&&c.addClass("wpglobus-focuskwresults"),wpseoMetaboxL10n.field_prefix+"metadesc"==b&&c.addClass("wpglobus-wpseo_metadesc").text(d.data("metadesc")),wpseoMetaboxL10n.field_prefix+"title"==b&&c.addClass("wpglobus-wpseo_title").val(d.data("wpseotitle")),wpseoMetaboxL10n.field_prefix+"focuskw"==b&&c.addClass("wpglobus-wpseo_focuskw").val(d.data("focuskw")),c.attr("id",b+"_"+g),jQuery("#"+b+"_"+g).attr("data-language",g)}),m="complete"==d.data("permalink")?d.data("url-"+g):d.data("url-"+g)+jQuery("#editable-post-name-full").text()+"/",jQuery("#wpseosnippet_"+g+" .url").text(m),f(g),"undefined"!=typeof jQuery().autocomplete){var h,i={};jQuery("#"+wpseoMetaboxL10n.field_prefix+"focuskw_"+g).autocomplete({minLength:3,formatResult:function(a){return jQuery("<div/>").html(a).html()},source:function(a,b){var c=a.term;return c in i?void b(i[c]):(a._ajax_nonce=wpseoMetaboxL10n.wpseo_keyword_suggest_nonce,a.action="wpseo_get_suggest",void(h=jQuery.getJSON(ajaxurl,a,function(a,d,e){i[c]=a,e===h&&b(a)})))}})}jQuery("#"+wpseoMetaboxL10n.field_prefix+"title_"+g).keyup(function(){e(!1,jQuery(this).data("language"))}),jQuery("#title_"+g).keyup(function(){var a=jQuery(this).data("language")?jQuery(this).data("language"):WPGlobusAdmin.data.default_language;e(!1,a),c(a)}),0==a&&jQuery("#title").keyup(function(){e(!1,WPGlobusAdmin.data.default_language),c(WPGlobusAdmin.data.default_language)}),0==a&&jQuery("body").on("change","#parent_id",function(){jQuery.each(WPGlobusAdmin.data.enabled_languages,function(a,b){e(!1,b),c(b)})}),jQuery("#"+wpseoMetaboxL10n.field_prefix+"metadesc_"+g).keyup(function(){c(jQuery(this).data("language"))}),jQuery("body").on("keyup","#excerpt-"+g,function(){c(jQuery(this).data("language")?jQuery(this).data("language"):WPGlobusAdmin.data.default_language)}),0==a&&jQuery(".wpglobus-editor").focusout(function(){c(jQuery(this).data("language"))});var n=!1;jQuery(document).on("change","#"+wpseoMetaboxL10n.field_prefix+"focuskw_"+g,function(){var a=jQuery(this).data("language"),b=jQuery("#focuskwhelp_"+a);jQuery("#"+wpseoMetaboxL10n.field_prefix+"focuskw_"+a).val().search(",")!=-1?(b.click(),n=!0):n&&(b.qtip("hide"),n=!1),f(a)})}),j.addClass("hidden"),jQuery("body").on("change",".wpglobus-wpseo_metadesc",function(a){var b="#"+wpseoMetaboxL10n.field_prefix+"metadesc",c=jQuery(this);jQuery(b).val(WPGlobusCore.getString(jQuery(b).val(),c.val(),c.data("language")))}),jQuery("body").on("change",".wpglobus-wpseo_title",function(a){var b="#"+wpseoMetaboxL10n.field_prefix+"title",c=jQuery(this);jQuery(b).val(WPGlobusCore.getString(jQuery(b).val(),c.val(),c.data("language")))}),jQuery("body").on("change",".wpglobus-wpseo_focuskw",function(a){var b="#"+wpseoMetaboxL10n.field_prefix+"focuskw",c=jQuery(this);jQuery(b).val(WPGlobusCore.getString(jQuery(b).val(),c.val(),c.data("language")))}),jQuery("body").on("click",".wpglobus-post-body-tabs-list li",function(a){$this=jQuery(this),$this.hasClass("wpglobus-post-tab")&&jQuery("#wpglobus-wpseo-tabs").tabs("option","active",jQuery(this).data("order"))}),g(),yst_updateSnippet()}};