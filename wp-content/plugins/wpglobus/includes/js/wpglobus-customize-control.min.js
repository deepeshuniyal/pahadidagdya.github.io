var WPGlobusCustomize;jQuery(document).ready(function(e){"use strict";if(void 0!==WPGlobusCoreData.customize){var t={languages:{},index:0,length:0,positionSet:!1,selectorHtml:'<span style="margin-left:5px;" class="wpglobus-icon-globe"></span><span style="font-weight:bold;">{{language}}</span>',init:function(o){e.each(WPGlobusCoreData.enabled_languages,function(e,o){t.languages[e]=o,t.length=e}),t.addLanguageSelector(),t.setElements(),t.addListeners()},setTitle:function(){e(WPGlobusCoreData.customize.info.element).html(WPGlobusCoreData.customize.info.html)},getString:function(t){var o=WPGlobusCore.getTranslations(t),a=[],s=0;return e.each(o,function(e,t){a[s]=""==t?"null":t,s++}),a=a.join(":::")},setElements:function(){t.setTitle();var o;e.each(WPGlobusCoreData.customize.addElements,function(a,s){var n=e(s.element);n.attr("id",a).val(s.value).trigger("change"),"textarea"==s.type&&void 0!==s.textarea_attrs&&n.addClass(s.textarea_attrs.class),void 0!==s.options&&(void 0!==s.options.setValue&&s.options.setValue&&(o=e(s.origin_element).val(),n.data("source",o),n.val(WPGlobusCore.TextFilter(o,WPGlobusCoreData.language,"RETURN_EMPTY")),n.hasClass("wpglobus-control-url")&&e(s.origin_element).val(t.getString(o))),void 0!==s.options.setLabel&&s.options.setLabel&&(e(s.title).text(e(s.origin_title).text()),e(s.description).text(e(s.origin_description).text()))),n.on("change",function(o){var a=e(this),s=e(WPGlobusCoreData.customize.addElements[e(this).data("customize-setting-link")].origin_element);a.data("source",WPGlobusCore.getString(a.data("source"),a.val())),a.hasClass("wpglobus-control-url")?s.val(t.getString(a.data("source"))):s.val(WPGlobusCore.getString(s.val(),a.val())),a.hasClass("wpglobus-not-trigger-change")||s.trigger("change")})})},addLanguageSelector:function(){e('<a style="margin-left:48px;" class="customize-controls-close wpglobus-customize-selector"><span class="wpglobus-globe"></span></a>').insertAfter(".customize-controls-preview-toggle"),e(".wpglobus-customize-selector").html(t.selectorHtml.replace("{{language}}",WPGlobusCoreData.language))},setPosition:function(t){void 0!==t.options.setPosition&&t.options.setPosition&&(e(t.parent).detach().insertBefore(t.origin_parent),e(t.parent).css({display:"block"}))},addListeners:function(){e(document).on("click",".control-section",function(o){t.positionSet||(t.positionSet=!0,e.each(WPGlobusCoreData.customize.addElements,function(o,a){e(a.origin_parent).css({display:"none"}),e(a.origin_parent+" label").css({display:"none"}),void 0!==a.options&&t.setPosition(a)}))}),e(document).on("click",".wpglobus-customize-selector",function(o){t.index>t.length-1?t.index=0:t.index++,WPGlobusCoreData.language=t.languages[t.index],e(this).html(t.selectorHtml.replace("{{language}}",WPGlobusCoreData.language)),e(".wpglobus-customize-control").each(function(t,o){if(void 0!==WPGlobusCoreData.customize.addElements[e(o).data("customize-setting-link")]){var a=e(WPGlobusCoreData.customize.addElements[e(o).data("customize-setting-link")].origin_element),s=e(o);s.hasClass("wpglobus-control-url")?s.val(WPGlobusCore.TextFilter(s.data("source"),WPGlobusCoreData.language,"RETURN_EMPTY")):s.val(WPGlobusCore.TextFilter(a.val(),WPGlobusCoreData.language,"RETURN_EMPTY"))}})}),e(document).ajaxSend(function(t,o,a){if(void 0!==a.data&&a.data.indexOf("action=customize_save")>=0){var s,n,i=a.data.split("&");e.each(i,function(e,t){"customized"!=(s=t.split("="))[0]||(n=s[1])});var l=decodeURIComponent(n);l=JSON.parse(l),e.each(WPGlobusCoreData.customize.addElements,function(t,o){void 0!==l[t]&&(l[o.origin]=e(WPGlobusCoreData.customize.addElements[t].origin_element).val())}),a.data=a.data.replace(n,JSON.stringify(l))}})}};(WPGlobusCustomize=e.extend({},WPGlobusCustomize,t)).init()}});