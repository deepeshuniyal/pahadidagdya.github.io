var WPGlobusCore;!function(t){var a;a=WPGlobusCore={strpos:function(t,a,e){var o=(t=""+t).indexOf(a,e);return o>=0&&o},TextFilter:function(t,e,o){if(void 0===t||""===t)return t;var n,i,l=[],s=!1;e=""==e?"en":e,o=void 0===o||""==o?"RETURN_IN_DEFAULT_LANGUAGE":o,l[0]=[],l[0].start=WPGlobusCoreData.locale_tag_start.replace("%s",e),l[0].end=WPGlobusCoreData.locale_tag_end,l[1]=[],l[1].start="\x3c!--:"+e+"--\x3e",l[1].end="\x3c!--:--\x3e",l[2]=[],l[2].start="[:"+e+"]",l[2].end="[:";for(var d=0;d<3;d++)if(!1!==(n=a.strpos(t,l[d].start))){n+=l[d].start.length,t=!1===(i=a.strpos(t,l[d].end,n))?t.substr(n):t.substr(n,i-n),s=!0;break}return s||("RETURN_EMPTY"==o?(e!=WPGlobusCoreData.default_language||/(\{:|\[:|<!--:)[a-z]{2}/.test(t))&&(t=""):e==WPGlobusCoreData.default_language?/(\{:|\[:|<!--:)[a-z]{2}/.test(t)&&(t=""):t=a.TextFilter(t,WPGlobusCoreData.default_language)),t},addLocaleMarks:function(t,a){return WPGlobusCoreData.locale_tag_start.replace("%s",a)+t+WPGlobusCoreData.locale_tag_end},getTranslations:function(e){var o,n={};return t.each(WPGlobusCoreData.enabled_languages,function(t,i){o=i==WPGlobusCoreData.default_language?"RETURN_IN_DEFAULT_LANGUAGE":"RETURN_EMPTY",n[i]=a.TextFilter(e,i,o)}),n},getString:function(e,o,n){if(void 0===e)return e;void 0===o&&(o=""),void 0===n&&(n=WPGlobusCoreData.language),(e=a.getTranslations(e))[n]=o;var i="";return t.each(e,function(t,e){""!=e&&t!=WPGlobusCoreData.default_language&&(i+=a.addLocaleMarks(e,t))}),""!=e[WPGlobusCoreData.default_language]&&(i=""==i?e[WPGlobusCoreData.default_language]:a.addLocaleMarks(e[WPGlobusCoreData.default_language],WPGlobusCoreData.default_language)+i),i}}}(jQuery);var WPGlobusDialogApp;!function(t){var a;a=WPGlobusDialogApp={option:{listenClass:".wpglobus_dialog_start",settingsClass:".wpglobus_dialog_settings",dialogTabs:"#wpglobus-dialog-tabs",dialogTitle:"",customData:null,callback:function(){},dialogOptions:{title:"",placeholder:"",formFooter:"",beforeOpen:function(){},close:function(){}},dialog:{}},form:void 0,element:void 0,element_by:"id",id:"",clone_id:"",wpglobus_id:"",type:"textarea",source:"",order:{},value:{},request:"core",attrs:{},dialogTitle:"",trClass:"wpglobus-translatable",startButton:['<span id="wpglobus-dialog-start-{{clone_id}}" ','style="{{style}}" ','data-type="control" data-dialog-title="{{title}}" ','data-source-type="" data-source-id="{{id}}" data-source-name="{{name}}" ','data-nodename="{{nodename}}"',"{{sbTitle}} ",'class="{{classes}}"></span>'].join(""),startButtonClass:"wpglobus_dialog_start wpglobus_dialog_icon",clicks:0,init:function(e){a.option.dialog=a.option.dialogOptions,a.option=t.extend(a.option,e),t(a.option.dialogTabs).tabs(),a.dialogTitle=a.option.dialogTitle,this.attachListener(),null!=a.option.customData&&void 0!==a.option.customData.addElements&&t.each(a.option.customData.addElements,function(t,e){a.addElement(e)})},convertToId:function(t){return t=t.replace(/\]/g,""),t=t.replace(/\[/g,"-")},addElement:function(e){var o={id:null,style:"",styleTextareaWrapper:"",sbTitle:"",onChangeClass:"",dialogTitle:"",dialog:a.option.dialogOptions};if("string"==typeof e)o.id=e;else{if("object"!=typeof e)return;o=t.extend(o,e)}var n,i,l,s=null,d=null,u=null,r=null,c=a.startButton,g="";if(a.element_by="name",0==(r=document.getElementsByName(o.id)).length&&(a.element_by="id",r=document.getElementById(o.id)),null!==r){if(d=o.id,"id"==a.element_by?s=t("#"+d):(g=(g=r[0].nodeName).toLowerCase(),s=t(g+'[name="'+d+'"]')),u=void 0===s.attr("name")||""==s.attr("name")?d:s.attr("name"),a.clone_id=a.convertToId(d),-1!=u.indexOf("wpglobus")||-1!=a.clone_id.indexOf("wpglobus"))return!1;if(t("#wpglobus-"+a.clone_id).length>0)return!1;if(t(g+'[name="wpglobus-'+u+'"]').length>0)return!1;n=t(s.clone()),l=s.attr("style")||"",s.attr("style","display:none;"),n.attr("id","wpglobus-"+a.clone_id).attr("name","wpglobus-"+u),n.addClass(a.trClass),""!=o.onChangeClass&&n.addClass(o.onChangeClass),"id"==a.element_by?n.attr("data-source-id",d).attr("data-source-name","").attr("data-source-get-by",a.element_by):n.attr("data-source-id","").attr("data-source-name",u).attr("data-source-get-by",a.element_by),"textarea"==g?(i=WPGlobusCore.getTranslations(s.val())[WPGlobusCoreData.language],n.val(i),n.attr("data-nodename","textarea"),""==o.style?n.attr("style",l+";width:95%;float:left;"):n.attr("style",l+";"+o.style)):(i=WPGlobusCore.getTranslations(s.val())[WPGlobusCoreData.language],n.attr("value",i),n.attr("data-nodename","input"),""!=o.style&&n.attr("style",l+";"+o.style)),""!=o.dialog&&n.attr("data-dialog",JSON.stringify(o.dialog)),c=c.replace(/{{clone_id}}/g,a.clone_id),c="id"==a.element_by?(c=(c=c.replace(/{{id}}/g,a.clone_id)).replace(/{{name}}/g,"")).replace(/{{nodename}}/g,""):(c=(c=c.replace(/{{id}}/g,"")).replace(/{{name}}/g,u)).replace(/{{nodename}}/g,g),c="textarea"==g?c.replace("{{style}}","float:left;margin-top:0;"):c.replace("{{style}}","");var b="textarea"==g?a.startButtonClass+" wpglobus-textarea wpglobus-textarea-"+a.clone_id:a.startButtonClass;c=c.replace("{{classes}}",b),c=""==o.dialogTitle?c.replace("{{title}}",a.dialogTitle):c.replace("{{title}}",o.dialogTitle),c=""==o.sbTitle?c.replace("{{sbTitle}}",o.sbTitle):c.replace("{{sbTitle}}",'title="'+o.sbTitle+'"'),t(c).insertAfter(s),t(n).insertAfter(s),"textarea"==g&&(t("#wpglobus-"+a.clone_id).addClass("wpglobus-textarea-"+a.clone_id),t(".wpglobus-textarea-"+a.clone_id).wrapAll('<div class="wpglobus-textarea-wrapper" style="'+o.styleTextareaWrapper+'"></div>'));var p,m=!1;if(""==o.onChangeClass)p="#wpglobus-"+a.clone_id;else{p="."+o.onChangeClass;var v=t._data(t(document)[0],"events");void 0===v?m=!0:void 0!==v.change&&t.each(v.change,function(t,a){if(a.selector==p)return m=!0,!1})}return!!m||(t(document).on("change",p,function(){var a=t(this),e=a.data("source-id");e=""==e?a.data("nodename")+'[name="'+a.data("source-name")+'"]':"#"+e,t(e).val(WPGlobusCore.getString(t(e).val(),a.val()))}),!0)}},saveDialog:function(){var e,o,n,i="",l="",s="";t(".wpglobus_dialog_textarea").each(function(a,d){e=t(d),o=e.val(),(n=e.data("language"))==WPGlobusAdmin.data.language&&(s=o),""!=o&&(i+=WPGlobusCore.addLocaleMarks(o,n),n==WPGlobusCoreData.default_language&&(l=o))}),i=i.length==l.length+8?l:i,t(a.id).val(i),i=""==s?l:s,t(a.wpglobus_id).val(i)},dialog:t("#wpglobus-dialog-wrapper").dialog({autoOpen:!1,width:650,modal:!0,dialogClass:"wpglobus-dialog",buttons:[{text:"Save",class:"wpglobus-button-save",click:function(){a.saveDialog(),a.dialog.dialog("close")}},{text:"Cancel",class:"wpglobus-button-cancel",click:function(){a.dialog.dialog("close")}}],open:function(e,o){var n=a.dialogTitle;void 0!==a.attrs.maxlength&&(t(".wpglobus_dialog_textarea").attr("maxlength",a.attrs.maxlength),n+=" | maxlength="+a.attrs.maxlength),t(".wpglobus-dialog .ui-dialog-title").text(n)},close:function(){a.runCallback(a.option.dialog.close),a.form[0].reset()}}),attachListener:function(){t(document).on("click",a.option.settingsClass,function(){t(".wpglobus_dialog_options_wrapper").hasClass("hidden")?t(".wpglobus_dialog_options_wrapper").removeClass("hidden"):t(".wpglobus_dialog_options_wrapper").addClass("hidden")}),t(document).on("click",".wpglobus_dialog_option",function(e){var o=t(this),n=o.data("object");a.order.action="save_post_meta_settings",a.order.post_type=WPGlobusAdmin.data.post_type,a.order.checked=o.prop("checked"),a.order.id=o.attr("id"),a.order.meta_key=o.data("meta-key"),a.ajax(a.order).done(function(a){"ok"==a.result&&("true"==a.checked?t(n).removeClass("wpglobus_dialog_start_hidden"):t(n).addClass("wpglobus_dialog_start_hidden"))}).fail(function(t){}).always(function(t,a){})}),t(document).on("click",a.option.listenClass,function(e){a.element=t(this),a.id=a.element.data("source-id"),""==a.id?(a.id=a.element.data("nodename")+'[name="'+a.element.data("source-name")+'"]',a.wpglobus_id="#wpglobus-"+a.convertToId(a.element.data("source-name"))):(a.wpglobus_id="#wpglobus-"+a.id,a.id="#"+a.id),1==++a.clicks&&setTimeout(function(){if(1==a.clicks)a.onClick(e);else{var o=t(a.id);o.hasClass("hidden")?o.removeClass("hidden").attr("style","display:block;"):o.addClass("hidden").attr("style","display:none;")}a.clicks=0},200)}),a.form=a.dialog.find("form#wpglobus-dialog-form").on("submit",function(t){t.preventDefault(),a.saveDialog()})},ajax:function(a){return t.ajax({type:"POST",url:WPGlobusAdmin.ajaxurl,data:{action:WPGlobusAdmin.process_ajax,order:a},dataType:"json",async:!1})},onClick:function(e){void 0===a.element.data("dialog-title")||""==a.element.data("dialog-title")?a.dialogTitle=a.option.dialogTitle:a.dialogTitle=a.element.data("dialog-title"),void 0!==a.id&&(a.attrs.maxlength=t(a.id).attr("maxlength")),a.source=a.element.data("source-value"),void 0===a.source&&(a.source=t(a.id).val(),"ajax"==a.request||(a.value=WPGlobusCore.getTranslations(a.source))),a.option.dialog=t.extend({},a.option.dialogOptions,t(a.wpglobus_id).data("dialog")),""!=a.option.dialog.title&&(a.dialogTitle=a.option.dialog.title),t.each(a.value,function(e,o){var n=t("#wpglobus-dialog-"+e);n.val(o),n.attr("placeholder",WPGlobusCore.TextFilter(a.option.dialog.placeholder,e,"RETURN_IN_DEFAULT_LANGUAGE"))}),t("#wpglobus-dialog-form-footer").html(a.option.dialog.formFooter),a.runCallback(a.option.dialog.beforeOpen),a.dialog.dialog("open")},runCallback:function(t){if("object"==typeof t){var a=Object.keys(t)[0],e=t[Object.keys(t)[0]];"window"===a?"function"==typeof window[e]&&window[e](t[Object.keys(t)[1]]):"function"==typeof window[a][e]&&window[a][e](t[Object.keys(t)[1]])}else"string"==typeof t&&"function"==typeof window[t]&&window[t]()}}}(jQuery),jQuery(document).ready(function(){"use strict";window.WPGlobusAdminApp=function(t,a){return t.App=function(t){void 0===window.WPGlobusAdminApp&&(this.config={debug:!1,version:WPGlobusAdmin.version},this.status="ok","undefined"==typeof WPGlobusAdmin?(this.status="error",this.config.debug&&console.log("WPGlobus: error options loading")):this.config.debug&&console.dir(WPGlobusAdmin),this.config.disable_first_language=['<div id="disable_first_language" style="display:block;" class="redux-field-errors notice-red">',"<strong>","<span>&nbsp;</span>",WPGlobusAdmin.i18n.cannot_disable_language,"</strong>","</div>"].join(""),a.extend(this.config,t),"ok"===this.status&&this.init())},t.App.prototype={$document:a(document),init:function(){WPGlobusCoreData.multisite=this.parseBool(WPGlobusCoreData.multisite),this.adminInit(),a("#content").addClass("wpglobus-editor").attr("data-language",WPGlobusAdmin.data.default_language),a("textarea[id^=content_]").each(function(t,e){var o=a(e).attr("id").replace("content_","");a(e).attr("data-language",o)}),"post.php"===WPGlobusAdmin.page?(this.postEdit(),this.set_dialog(),"undefined"!=typeof WPGlobusAioseop&&WPGlobusAioseop.init()):"menu-edit"===WPGlobusAdmin.page?this.navMenus():"taxonomy-edit"===WPGlobusAdmin.page?WPGlobusAdmin.data.tag_id&&this.taxonomyEdit():"taxonomy-quick-edit"===WPGlobusAdmin.page?this.quickEdit("taxonomy"):"edit.php"===WPGlobusAdmin.page?this.quickEdit("post"):"options-general.php"==WPGlobusAdmin.page?this.optionsGeneral():"widgets.php"==WPGlobusAdmin.page?(WPGlobusWidgets.init(),WPGlobusDialogApp.init({dialogTitle:"Edit text"})):"wpglobus_options"==WPGlobusAdmin.page?this.start():"wpglobusAdminCentral"==WPGlobusAdmin.page?this.adminCentral():WPGlobusDialogApp.init({customData:WPGlobusCoreData.page_custom_data})},parseBool:function(t){return!/^(false|0)$/i.test(t)&&!!t},getCurrentTab:function(){return a(".wpglobus-post-body-tabs-list .ui-tabs-active").data("language")},adminInit:function(){var t=a(".wpglobus-addons-group a").data("key");if(void 0!==t)if(window.location.search.indexOf("page=wpglobus_options&tab="+t)>=0)WPGlobusCoreData.multisite?window.location=WPGlobusCoreData.pluginInstallLocation.multisite:window.location=WPGlobusCoreData.pluginInstallLocation.single;else{var e=a("#toplevel_page_wpglobus_options li").eq(t+1);WPGlobusCoreData.multisite?a(e).find("a").attr("href",WPGlobusCoreData.pluginInstallLocation.multisite).attr("onclick","window.location=jQuery(this).attr('href');return false;"):a(e).find("a").attr("href",WPGlobusCoreData.pluginInstallLocation.single).attr("onclick","window.location=jQuery(this).attr('href');return false;")}},optionsGeneral:function(){var t=a("#blogname"),e=a("body");t.addClass("hidden"),a("#wpglobus-blogname").insertAfter(t).removeClass("hidden"),e.on("blur",".wpglobus-blogname",function(){a(".wpglobus-blogname").each(function(e,o){var n=a(o);t.val(WPGlobusCore.getString(t.val(),n.val(),n.data("language")))})});var o=a("#blogdescription");o.addClass("hidden"),a("#wpglobus-blogdescription").insertAfter(o).removeClass("hidden"),e.on("blur",".wpglobus-blogdesc",function(){a(".wpglobus-blogdesc").each(function(t,e){var n=a(e);o.val(WPGlobusCore.getString(o.val(),n.val(),n.data("language")))})})},quickEdit:function(t){if(void 0!==WPGlobusAdmin.data.has_items&&WPGlobusAdmin.data.has_items){var e="",o=0;a(document).ajaxComplete(function(t,n,i){void 0!==i.data&&""!=e&&i.data.indexOf("action=inline-save-tax&")>=0&&(a("#"+e+" a.row-title").text(WPGlobusAdmin.qedit_titles[o][WPGlobusAdmin.data.language].name),a("#"+e+" .description").text(WPGlobusAdmin.qedit_titles[o][WPGlobusAdmin.data.language].description))});var n={};a("#the-list tr").each(function(e,i){var l=a(i),s="post"===t?"post-":"tag-";o=l.attr("id").replace(s,""),n[o]={},"post"===t?n[o].source=l.find(".post_title").text():"taxonomy"===t&&(n[o].source=a("#inline_"+o+" .name").text())});var i={};i.action="get_titles",i.type=t,i.taxonomy=void 0!==WPGlobusAdmin.data.taxonomy&&WPGlobusAdmin.data.taxonomy,i.title=n,a.ajax({type:"POST",url:WPGlobusAdmin.ajaxurl,data:{action:WPGlobusAdmin.process_ajax,order:i},dataType:"json"}).done(function(t){WPGlobusAdmin.qedit_titles=t.qedit_titles,a.each(t.bulkedit_post_titles,function(t,e){a("#inline_"+t+" .post_title").text(e[WPGlobusAdmin.data.language].name)})}).fail(function(t){}).always(function(t,a){}),a("body").on("change",".wpglobus-quick-edit-title",function(){var t="",e=[];a(".wpglobus-quick-edit-title").each(function(n,i){var l=a(i),s=l.data("language");""!==l.val()&&(t=WPGlobusCore.getString(t,l.val(),s)),WPGlobusAdmin.qedit_titles[o][s].name=l.val(),e[n]=s});var n=a(document).triggerHandler("wpglobus_get_translations",{string:t,lang:e,id:o});void 0!==n&&(t=n),a("input.ptitle").eq(0).attr("value",t),WPGlobusAdmin.qedit_titles[o].source=t}),void 0!==WPGlobusAdmin.data.tags&&a.each(WPGlobusAdmin.data.tags,function(t,a){WPGlobusAdmin.data.value[a].post_id={}}),a("button.save, input#bulk_edit").on("mouseenter",function(t){void 0!==WPGlobusAdmin.data.tags&&("bulk_edit"==t.currentTarget.id?a("input#bulk_edit").unbind("click"):a("button.save").unbind("click"),a("button.save, input#bulk_edit").on("click",function(t){var e=a.when(),n=(a(this),a.Deferred());n.resolve(function(e){e.next(".spinner").css({visibility:"visible"}),"bulk_edit"!=t.currentTarget.id&&a.ajaxSetup({async:!1});var o,n,i,l=e.parents("tr"),s=l.attr("id").replace("edit-","");a.each(WPGlobusAdmin.data.tags,function(t,a){if(0==(o=l.find("textarea[name='"+WPGlobusAdmin.data.names[a]+"']")).length)return!0;WPGlobusAdmin.data.value[a].post_id[s]=o.val(),n=WPGlobusAdmin.data.value[a].post_id[s].split(","),i=[];for(var e=0;e<n.length;e++)n[e]=n[e].trim(" "),""!=n[e]&&(void 0===WPGlobusAdmin.data.tag[a][n[e]]?i[e]=n[e]:i[e]=WPGlobusAdmin.data.tag[a][n[e]]);o.val(i.join(", "))})}(a(this))),e=e.then(function(){return a.when(n.done())}).then(function(){"bulk_edit"!=t.currentTarget.id&&setTimeout(function(){inlineEditPost.save(o),a.ajaxSetup({async:!0})},50)})}))}),a("#the-list").on("click","a.editinline",function(){var n=a(this);if(e=n.parents("tr").attr("id"),"post"===t)o=e.replace("post-","");else{if("taxonomy"!==t)return;o=e.replace("tag-","")}"post"===t&&void 0!==WPGlobusAdmin.data.tags&&a.each(WPGlobusAdmin.data.tags,function(t,e){if(""!=WPGlobusAdmin.data.value[e]){var n,i=a("#edit-"+o+' textarea[name="'+WPGlobusAdmin.data.names[e]+'"]').val();void 0!==i&&(n=i.split(","),a.each(n,function(t,a){i=i.replace(a,WPGlobusCore.TextFilter(a,WPGlobusCoreData.language))}),a("#edit-"+o+' textarea[name="'+WPGlobusAdmin.data.names[e]+'"]').val(i))}});var i=a("#edit-"+o+" input.ptitle").eq(0),l=i.parents("label");i.val(WPGlobusAdmin.qedit_titles[o].source),i.addClass("hidden"),a(WPGlobusAdmin.data.template).insertAfter(l),void 0===WPGlobusAdmin.qedit_titles[o]&&(WPGlobusAdmin.qedit_titles[o]={},WPGlobusAdmin.qedit_titles[o].source=a("#"+e+" .name a.row-title").text(),a(WPGlobusAdmin.data.enabled_languages).each(function(t,a){WPGlobusAdmin.qedit_titles[o][a]={},a==WPGlobusAdmin.data.default_language?WPGlobusAdmin.qedit_titles[o][a].name=WPGlobusAdmin.qedit_titles[o].source:WPGlobusAdmin.qedit_titles[o][a].name="",WPGlobusAdmin.qedit_titles[o][a].description=""})),a(".wpglobus-quick-edit-title").each(function(t,e){var n=a(e),i=n.data("language");n.attr("id",i+o),void 0!==WPGlobusAdmin.qedit_titles[o][i]&&(WPGlobusAdmin.qedit_titles[o][i].name=WPGlobusAdmin.qedit_titles[o][i].name.replace(/\\\'/g,"'"),WPGlobusAdmin.qedit_titles[o][i].name=WPGlobusAdmin.qedit_titles[o][i].name.replace(/\\\"/g,'"'),n.attr("value",WPGlobusAdmin.qedit_titles[o][i].name),WPGlobusAdmin.qedit_titles[o].source=WPGlobusCore.getString(WPGlobusAdmin.qedit_titles[o].source,WPGlobusAdmin.qedit_titles[o][i].name,i))}),a("input.ptitle").eq(0).attr("value",WPGlobusAdmin.qedit_titles[o].source)})}},taxonomyEdit:function(){var t=[];t[0]="name",t[1]="description";var e=function(t,e){var o,n=a("#"+t),i=n.clone(),l=n.attr("name"),s="wpglobus-element wpglobus-element_"+t+" wpglobus-element_"+e+" wpglobus-translatable";o=(o=document.getElementById(t)).nodeName,a(i).attr("id",t+"_"+e),a(i).attr("name",l+"_"+e),e!==WPGlobusCoreData.default_language&&(s+=" hidden"),a(i).attr("class",s),a(i).attr("data-save-to",t),a(i).attr("data-language",e),"INPUT"==o?a(i).attr("value",a("#wpglobus-link-tab-"+e).data(t)):"TEXTAREA"==o&&a(i).text(a("#wpglobus-link-tab-"+e).data(t)),n.addClass("hidden"),0==a(".wpglobus-element_"+t).length?a(i).insertAfter(n):a(i).insertAfter(a(".wpglobus-element_"+t).last())};a.each(WPGlobusCoreData.enabled_languages,function(o,n){a.each(t,function(t,a){e(a,n)})}),a(".wpglobus-taxonomy-tabs").insertAfter("#ajax-response"),a(".wrap").tabs(),a("body").on("click",".wpglobus-taxonomy-tabs li",function(t){var e=a(this).data("language");a(".wpglobus-element").addClass("hidden"),a(".wpglobus-element_"+e).removeClass("hidden")}),a(".wpglobus-element").on("change",function(){var t=a(this).data("save-to"),e="";a(".wpglobus-element").each(function(o,n){var i=a(n),l=i.val();i.data("save-to")==t&&""!==l&&(e+=WPGlobusCore.addLocaleMarks(l,i.data("language")))}),a("#"+t).val(e)})},navMenus:function(){var t,e,o="#menu-to-edit .menu-item",n=function(){e!==a(o).length&&(clearInterval(t),a(o).each(function(t,e){var o=a(e);if(!o.hasClass("wpglobus-menu-item")){var n=a(e).attr("id");a.each(["input.edit-menu-item-title","input.edit-menu-item-attr-title"],function(t,e){var o=a("#"+n+" "+e),i=a(o);if(!i.hasClass("wpglobus-hidden")){i.addClass("wpglobus-hidden"),i.css("display","none");var l=i.parent("label"),s=i.parents("p");a(s).css("height","80px"),a(l).append('<div style="color:#f00;">'+WPGlobusAdmin.i18n.save_nav_menu+"</div>")}}),o.addClass("wpglobus-menu-item")}}))};a.ajaxSetup({beforeSend:function(i,l){void 0!==l.data&&l.data.indexOf("action=add-menu-item")>=0&&(e=a(o).length,t=setInterval(n,500))}}),a(o).each(function(t,e){var o=a(e).attr("id"),n=o.replace("menu-item-","");a.each(["input.edit-menu-item-title","input.edit-menu-item-attr-title"],function(t,e){var i=a("#"+o+" "+e);i.val()!=WPGlobusAdmin.data.items[n][e].source&&i.val(WPGlobusAdmin.data.items[n][e].source);var l=a("#"+o+" "+e).parents("p"),s=0;a.each(WPGlobusAdmin.data.open_languages,function(o,d){var u=i.clone();u.attr("id",i.attr("id")+"-"+d),u.attr("name",i.attr("id")+"-"+d),u.attr("data-language",d),u.attr("data-item-id",n),u.attr("placeholder",WPGlobusAdmin.data.en_language_name[d]);var r=WPGlobusAdmin.data.items[n][d][e].class;0===t&&d===WPGlobusAdmin.data.default_language?u.attr("class",r+" edit-menu-item-title"):u.attr("class",r),""!=WPGlobusAdmin.data.items[n][d][e].caption?u.attr("value",WPGlobusAdmin.data.items[n][d][e].caption):u.attr("value",""),u.css("margin-bottom","0.6em"),a(l).append(u),s=o}),s=40*(s+1),i.css("display","none").attr("class","").addClass("widefat wpglobus-hidden"),a(l).css("height",s+"px").addClass("wpglobus-menu-item-box")}),a(e).addClass("wpglobus-menu-item")}),a(".menus-move-left, .menus-move-right").each(function(t,e){var o,n=a(e),i=(n.parents("li").attr("id").replace("menu-item-",""),n.attr("title"));void 0!==i&&a.each(WPGlobusAdmin.data.post_titles,function(t,a){i.indexOf(t)>=0&&(o=i.replace(t,a),n.attr("title",o),n.text(o))})}),a(".edit-menu-item-title").trigger("change"),wpNavMenu.refreshAdvancedAccessibility(),wpNavMenu.menusChanged=!1,a(".wpglobus-menu-item").on("change",function(){var t,e,o=a(this),n=o.data("item-id");o.hasClass("wpglobus-item-title")&&(t=WPGlobusCore.getString(a("input#edit-menu-item-title-"+n).val(),o.val(),o.data("language")),void 0!==(e=a(document).triggerHandler("wpglobus_get_menu_translations",{string:t,lang:WPGlobusCoreData.open_languages,id:n,type:"input.edit-menu-item-title"}))&&(t=e),a("input#edit-menu-item-title-"+n).val(t)),o.hasClass("wpglobus-item-attr")&&(t=WPGlobusCore.getString(a("input#edit-menu-item-attr-title-"+n).val(),o.val(),o.data("language")),void 0!==(e=a(document).triggerHandler("wpglobus_get_menu_translations",{string:t,lang:WPGlobusCoreData.open_languages,id:n,type:"input.edit-menu-item-attr-title"}))&&(t=e),a("input#edit-menu-item-attr-title-"+n).val(t))})},postEdit:function(){a(document).on("heartbeat-send",function(t,e){void 0!==e.wp_autosave&&(e.wpglobus_heartbeat="wpglobus",a.each(WPGlobusAdmin.data.open_languages,function(t,o){var n=a("#title_"+o).val()||"";""!=(n=a.trim(n))&&(e.wp_autosave["post_title_"+o]=n),n=a("#content_"+o).val()||"",""!=(n=a.trim(n))&&(e.wp_autosave["content_"+o]=n)}))});var t="#postdivrich",e=!0;if(!1===WPGlobusAdmin.data.support.editor&&(t="#titlediv",e=!1),!1===WPGlobusAdmin.data.support.title&&(e=!1),a("#post-body-content").prepend(a(".wpglobus-post-body-tabs-list")),a.each(WPGlobusAdmin.tabs,function(o,n){"default"===n?(a(t).wrap('<div id="tab-default"></div>'),e&&a(a("#titlediv")).insertBefore(t)):(a(t+"-"+n).wrap('<div id="tab-'+n+'"></div>'),e&&a(a("#titlediv-"+n)).insertBefore(t+"-"+n))}),a("#post-body-content").addClass("wpglobus-post-body-tabs").tabs({beforeActivate:function(t,e){var o=e.oldTab[0].id.replace("link-tab-",""),n=e.newTab[0].id.replace("link-tab-","");"default"==o&&(o=WPGlobusCoreData.default_language),"default"==n&&(n=WPGlobusCoreData.default_language);var i=a(document).triggerHandler("wpglobus_post_body_tabs",[o,n]);return!(!i&&void 0!==i)}}),a("#title").val(WPGlobusAdmin.title),a("#content").text(WPGlobusAdmin.content),"undefined"!=typeof WPGlobusVendor&&WPGlobusVendor.vendor.WPSEO&&("undefined"!=typeof wpglobus_wpseo?wpglobus_wpseo():"undefined"!=typeof WPGlobusYoastSeo&&("undefined"!=typeof WPGlobusYoastSeoPremium&&WPGlobusYoastSeoPremium&&WPGlobusYoastSeoPremium.init(),WPGlobusYoastSeo.init())),WPGlobusAdmin.data.modify_excerpt){var o=a("#excerpt");o.addClass("hidden").css({display:"none"}),a(WPGlobusAdmin.data.template).insertAfter(o),a("body").on("change",".wpglobus-excerpt",function(){var t=a(this);o.val(WPGlobusCore.getString(o.val(),t.val(),t.data("language")))})}if(void 0!==wp.utils&&void 0!==wp.utils.WordCounter){WPGlobusCoreData.wordCounter={};var n=this,i={};a.each(WPGlobusCoreData.enabled_languages,function(t,a){if(a==WPGlobusCoreData.default_language)return!0;i[t]="content_"+a,function(t,a,e){WPGlobusCoreData.wordCounter[e]={},WPGlobusCoreData.wordCounter[e].counter=a,t(function(){function a(t){var a,e;"object"==typeof t&&(t="tinymce"==t?n.getCurrentTab():t.target.id.replace("content_","")),void 0!==WPGlobusCoreData.wordCounter[t]&&(a=!WPGlobusCoreData.wordCounter[t].contentEditor||WPGlobusCoreData.wordCounter[t].contentEditor.isHidden()?WPGlobusCoreData.wordCounter[t].content.val():WPGlobusCoreData.wordCounter[t].contentEditor.getContent({format:"raw"}),(e=WPGlobusCoreData.wordCounter[t].counter.count(a))!==WPGlobusCoreData.wordCounter[t].prevCount&&WPGlobusCoreData.wordCounter[t].count.text(e),WPGlobusCoreData.wordCounter[t].prevCount=e)}WPGlobusCoreData.wordCounter[e].content=t("#content_"+e),WPGlobusCoreData.wordCounter[e].count=t("#wp-word-count-"+e).find(".word-count-"+e),WPGlobusCoreData.wordCounter[e].prevCount=0,t(document).on("tinymce-editor-init",function(e,o){if(-1!=t.inArray(o.id,i)){var n=o.id.replace("content_","");WPGlobusCoreData.wordCounter[n].contentEditor=o,o.on("nodechange keyup",_.debounce(a,1e3))}}),WPGlobusCoreData.wordCounter[e].content.on("input keyup",_.debounce(a,1e3)),a(e)})}(jQuery,new wp.utils.WordCounter,a)})}a(document).on("click","#publish, #save-post",function(){if(WPGlobusAdmin.data.open_languages.length>1){a(document).triggerHandler("wpglobus_before_save_post",{content_tabs_id:"#post-body-content"});var t,e=a("#title").val(),o="",n="";0==e.length&&(t=WPGlobusAdmin.data.open_languages.indexOf(WPGlobusAdmin.data.default_language),WPGlobusAdmin.data.open_languages.splice(t,1),a(WPGlobusAdmin.data.open_languages).each(function(t,i){n=0==t?"":"-",(e=a("#title_"+i).val()).length>0&&(0==o.length&&(n=""),o=o+n+e)})),o.length>0&&a("#title").val(o)}void 0===WPGlobusAdmin.data.tagsdiv||WPGlobusAdmin.data.tagsdiv.length<1||a(WPGlobusAdmin.data.tagsdiv).each(function(t,e){if(0==a("#"+e).length)return!0;var o=e.replace("tagsdiv-","");if("undefined"===o)return!0;if(0==a("#tax-input-"+o).length)return!0;var n,i=[];a("#tagsdiv-"+o+" .tagchecklist > span").each(function(t,e){n=a(e).html(),n=n.replace(/<button.*<\/button>&nbsp;/,""),void 0===WPGlobusAdmin.data.tag[o][n]?i[t]=n:i[t]=WPGlobusAdmin.data.tag[o][n]}),a("#tax-input-"+o).val(i.join(", "))})}),a(".ui-state-default").on("click",function(){"link-tab-default"===a(this).attr("id")&&(a(window).scrollTop(a(window).scrollTop()+1),a(window).scrollTop(a(window).scrollTop()-1))}),a(document).on("tabsactivate","#post-body-content",function(t,a){WPGlobusAdmin.currentTab=a.newTab[0].dataset.language}),a(document).triggerHandler("wpglobus_after_post_edit")},adminCentral:function(){a(".wpglobus-admin-central-tab").css({display:"none"}),a(".nav-tab-active").length>1&&a(".wpglobus-about-wrap .nav-tab-wrapper a").removeClass("nav-tab-active");var t=!0;0==location.hash.indexOf("#")&&a(".wpglobus-about-wrap .nav-tab-wrapper a").each(function(e,o){a(o).attr("href")==location.hash&&(t=!1,a(o).addClass("nav-tab-active"))}),t&&a(".wpglobus-about-wrap .nav-tab-wrapper a").eq(0).addClass("nav-tab-active");var e=a(".wpglobus-about-wrap .nav-tab-active").data("tab-id");""!=e&&a("#"+e).css({display:"block"}),a(document).on("click",".wpglobus-about-wrap .nav-tab",function(t){var e=a(this);e.hasClass("nav-tab-active")||(a(".wpglobus-admin-central-tab").css({display:"none"}),a(".wpglobus-about-wrap .nav-tab").removeClass("nav-tab-active"),e.addClass("nav-tab-active"),""!=e.data("tab-id")&&a("#"+e.data("tab-id")).css({display:"block"}))})},start:function(){var t=this;a("#wpglobus_flags").select2({formatResult:this.format,formatSelection:this.format,minimumResultsForSearch:-1,escapeMarkup:function(t){return t}}),a("body").on("click","#enabled_languages-list li:first input",function(e){return e.preventDefault(),a(".redux-save-warn").css({display:"none"}),a("#enabled_languages-list").find("li:first > input").val("1"),0===a("#disable_first_language").length&&a(t.config.disable_first_language).insertAfter("#info_bar"),!1})},format:function(t){return'<img class="wpglobus_flag" src="'+WPGlobusAdmin.flag_url+t.text+'"/>&nbsp;&nbsp;'+t.text},set_dialog:function(){if(void 0===WPGlobusAdmin.data.customFieldsEnabled||(WPGlobusAdmin.data.customFieldsEnabled=this.parseBool(WPGlobusAdmin.data.customFieldsEnabled),WPGlobusAdmin.data.customFieldsEnabled)){var t,e=!1,o=function(t){var o,n,i,l="wpglobus_dialog_start wpglobus_dialog_icon";i=['<div class="wpglobus_dialog_options_wrapper hidden">','<input style="width:initial;" id="wpglobus-cb-{{id}}" data-object="#wpglobus-dialog-start-{{id}}" data-meta-key="{{meta-key}}" class="wpglobus_dialog_option wpglobus_dialog_cb" type="checkbox" {{checked}} />',"</div>"].join(""),a(void 0===t?"#the-list tr":"#the-list tr#"+t).each(function(){var t,e,s,d=a(this),u=d.attr("id"),r=d.find("textarea"),c=l;if(void 0===(o=r.attr("id")))return!0;s=a("#"+u+"-key").val(),t=a("#"+o).clone(),a(r).addClass("wpglobus-dialog-field-source hidden"),e=r.attr("name"),a(t).attr("id","wpglobus-"+o),a(t).attr("name","wpglobus-"+e),a(t).attr("data-source-id",o),a(t).attr("class","wpglobus-dialog-field"),a(t).val(WPGlobusCore.TextFilter(a(r).val(),WPGlobusCoreData.language)),a(t).insertAfter(r),n=i.replace(/{{id}}/g,o),n=n.replace(/{{meta-key}}/g,s),void 0===WPGlobusAdmin.data.post_meta_settings[WPGlobusAdmin.data.post_type]?n=n.replace(/{{checked}}/,"checked"):void 0!==WPGlobusAdmin.data.post_meta_settings[WPGlobusAdmin.data.post_type][s]&&"false"==WPGlobusAdmin.data.post_meta_settings[WPGlobusAdmin.data.post_type][s]?(n=n.replace(/{{checked}}/,""),c=l+" wpglobus_dialog_start_hidden"):(n=n.replace(/{{checked}}/,"checked"),c=l),d.append('<td style="width:20px;"><div id="wpglobus-dialog-start-'+o+'" data-type="control" data-source-type="textarea" data-source-id="'+o+'" class="'+c+'"></div>'+n+"</td>")}),!e&&a("#list-table .wpglobus_dialog_start").length>0&&(a("#list-table thead tr").append('<th class="wpglobus-control-head"><div class="wpglobus_dialog_settings wpglobus_dialog_icon"></div></th>'),e=!0)};o(),a("body").on("change",".wpglobus-dialog-field",function(){var t,e=a(this),o="#"+e.data("source-id"),n="",i="";void 0!==o&&(n=a(o).val(),/(\{:|\[:|<!--:)[a-z]{2}/.test(n)?(a.each(WPGlobusCoreData.enabled_languages,function(a,o){""!=(t=o==WPGlobusCoreData.language?e.val():WPGlobusCore.TextFilter(n,o,"RETURN_EMPTY"))&&(i+=WPGlobusCore.addLocaleMarks(t,o))}),a(o).val(i)):a(o).val(e.val()))}),a(document).ajaxSend(function(a,e,o){"add-meta"==o.action&&(t=o.element)}),a(document).ajaxComplete(function(e,n,i){"add-meta"==i.action&&void 0!==n.responseXML&&o("newmeta"==t?"meta-"+a(n.responseXML.documentElement.outerHTML).find("meta").attr("id"):t)}),WPGlobusDialogApp.init({dialogTitle:"Edit meta"})}}},new t.App,t}(window.WPGlobusAdminApp||{},jQuery)});